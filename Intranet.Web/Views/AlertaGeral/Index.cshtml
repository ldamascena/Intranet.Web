<html lang="en" ng-app="alertaApp">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <script src="~/scripts/angular.js" type="text/javascript" language="javascript"></script>
    @*Iniciação do módulo*@
    <script src="~/scripts/alertaApp.js" type="text/javascript" language="javascript"></script>
    @*Iniciação do Controllers*@
    <script src="~/scripts/Controllers/listaAlertaCtrl.js" type="text/javascript" language="javascript"></script>

    @*Iniciação do Services*@
    <script src="~/scripts/Services/AlertaGeralService.js" type="text/javascript" language="javascript"></script>
    <script src="~/scripts/Services/ProdutoService.js" type="text/javascript" language="javascript"></script>
    <script src="~/scripts/Services/EmpresaFilialService.js" type="text/javascript" language="javascript"></script>
    <script src="~/scripts/Services/AlertaManualService.js" type="text/javascript" language="javascript"></script>
    <script src="~/scripts/Services/AlertaTipoService.js" type="text/javascript" language="javascript"></script>
    <script src="~/scripts/Services/ProdutoService.js" type="text/javascript" language="javascript"></script>


    <script src="~/scripts/angular-route.js" type="text/javascript" language="javascript"></script>
    <script src="~/scripts/angular-animate.js" type="text/javascript" language="javascript"></script>
    <script src="~/scripts/angular-sanitize.js" type="text/javascript" language="javascript"></script>
    <script src="~/scripts/angular-cookies.js" type="text/javascript" language="javascript"></script>

    <script src="~/scripts/angular-ui/ui-bootstrap.js" type="text/javascript" language="javascript"></script>
    <script src="~/scripts/angular-ui/ui-bootstrap-tpls.js" type="text/javascript" language="javascript"></script>
    <script src="~/scripts/Directive/select.js" type="text/javascript" language="javascript"></script>

    <link rel="stylesheet" href="~/Content/bootstrap.css" />
    <link rel="stylesheet" href="~/Content/select.css">
    <link rel="stylesheet" href="~/Content/Custom/Alerta/Principal.css" />

    <title>Index</title>

    <script type="text/javascript">



        app.controller("ModalInstanceCtrl", function ($scope, $uibModal, $uibModalInstance, $uibModalStack, $interval, ProdutoService, EmpresaFilialService, AlertaManualService, AlertaTipoService) {

            //$scope.tipoAlerta;

            $scope.searchByCodigo = function () {
                $uibModal.open({
                    templateUrl: 'modalLoad.html',
                    controller: 'ModalInstanceteste'
                });

            //    ProdutoService.GetById(parseInt($scope.cdProduto)).then(function (response) {
            //        $scope.cdProduto = response.data.idProduto
            //        $scope.produto = response.data.Descricao
            //    });
            }

            $scope.searchByProduto = function () {
                $uibModal.open({
                    templateUrl: 'modalLoad.html',
                    controller: 'ModalInstanceteste'
                });

            //    ProdutoService.GetByNomeProduto($scope.produto).then(function (response) {
            //        $scope.cdProduto = response.data.idProduto
            //        $scope.produto = response.data.Descricao
            //    });
            }



            $scope.addTipoAlerta = function () {
                $uibModal.open({
                    templateUrl: 'modalAddTipoAlerta.html',
                    controller: 'ModalInstanceNovoAlerta'
                });
            }

            //AlertaTipoService.GetAll().then(function (response) {
            //    $scope.tiposAlerta = response.data;
            //});


            //$scope.gravarAlerta = function () {
            //    $scope.submitted = true;
            //    if ($scope.appCtrl.filiais.length > 0 && $scope.cdProduto != undefined && $scope.produto != undefined && $scope.tipoAlerta != undefined) {
            //        for (var i = 0; i < $scope.appCtrl.filiais.length; i++) {
            //            $scope.obj = { CdProduto: $scope.cdProduto, nomeProduto: $scope.produto, cdPessoaFilial: $scope.appCtrl.filiais[i].cdPessoaFilial, CdTipoAlerta: $scope.tipoAlerta.CdTipoAlerta, tipoAlerta: $scope.tipoAlerta.NomeAlerta, Comentario: $scope.comentario };
            //            AlertaManualService.IncluirAlerta(angular.toJson($scope.obj));
            //        }
            //        $uibModalInstance.close('');
            //        location.reload();
            //    }
            //}
        });

        app.controller("ModalInstanceteste", function ($scope, $uibModal, $uibModalInstance, $uibModalStack, $interval) {
            var value = 0;
            $scope.dynamic = 0;

            $scope.increment = function () {
                if ($scope.dynamic != "100") {
                    value = value + 10;
                }

                if ($scope.dynamic == "100") {
                    value = 100;
                    $uibModalInstance.close();
                }
                $scope.dynamic = value;
            }

            $interval(function () {
                $scope.increment();
            }, 1000);

        });

        app.controller("ModalInstanceNovoAlerta", function ($scope, $uibModal, $uibModalInstance, $uibModalStack, $interval, AlertaTipoService) {
            $scope.gravarTipoAlerta = function () {

                if ($scope.alertaNovo != "" && $scope.alertaNovo != undefined) {
                    $scope.obj = { NomeAlerta: $scope.alertaNovo }
                    AlertaTipoService.IncluirAlerta(angular.toJson($scope.obj));

                    $uibModal.open({
                        templateUrl: 'success.html',
                        controller: 'ModalInstanceNovoAlerta'
                    });
                    $uibModalInstance.close('');
                }
            }
        });

        app.controller("ModalInstanceObsCtrl", function ($scope, $uibModal, $uibModalInstance, $interval, AlertaGeralService) {
            $scope.Gravar = function () {
                $scope.submitted = true;
                if (($scope.observacao != undefined && $scope.observacao != "") && ($scope.status != "" && $scope.status != undefined)) {
                    $scope.obj = {
                        CdProduto: $scope.idProduto, CdAlerta: $scope.idAlerta, DescricaoHistorico: $scope.observacao,
                        StatusAlertaAtual: $scope.status, cdTipoAlerta: $scope.tipoAlerta, cdPessoaFilial: $scope.idFilial, nomeUsuario: $scope.nomeUsuario
                    };

                    switch ($scope.tipoAlerta) {
                        case 1:
                            AlertaGeralService.CadastrarHistoricoManual(angular.toJson($scope.obj));
                            break;
                        case 2:
                            AlertaGeralService.CadastrarHistoricoInversao(angular.toJson($scope.obj));
                            break;
                        case 3:
                            AlertaGeralService.CadastrarHistoricoUltimoCusto(angular.toJson($scope.obj));
                    }

                    //AlertaGeralService.GetAllInversaoByProduto($scope.idProduto).then(function (response) {
                    //    $scope.dadosinversao = response.data;
                    //});

                    //AlertaGeralService.GetAllHistoricosPorProduto($scope.idProduto).then(function (response) {
                    //    $scope.dadosHistorico = response.data;
                    //});

                    //AlertaGeralService.GetAllUltCustoByProduto($scope.idProduto).then(function (response) {
                    //    $scope.dadosUltimoCusto = response.data;
                    //});

                    $interval(function () {
                        $uibModalInstance.close();
                    }, 1500);
                    
                }
            };

            $scope.Limpar = function () {
                window.document.getElementById("observacao").value = "";
            }

            $scope.cancel = function () {
                $uibModalInstance.dismiss();
            }
        });

        app.controller("ModalInstanceTodosCtrl", function ($scope, $uibModal, $uibModalInstance, $interval, AlertaGeralService) {
            $scope.Gravar = function () {
                $scope.submitted = true;
                if (($scope.observacao != undefined && $scope.observacao != "") && ($scope.status != "" && $scope.status != undefined)) {
                    $scope.obj = {
                        CdProduto: $scope.idProduto, DescricaoHistorico: $scope.observacao,
                        StatusAlertaAtual: $scope.status, cdTipoAlerta: $scope.tipoAlerta, nomeUsuario: $scope.nomeUsuario
                    };

                    switch ($scope.tipoAlerta) {
                        case 1:
                            AlertaGeralService.CadastrarHistoricosManual(angular.toJson($scope.obj));
                            break;
                        case 2:
                            AlertaGeralService.CadastrarHistoricosInversao(angular.toJson($scope.obj));
                            break;
                        case 3:
                            AlertaGeralService.CadastrarHistoricosUltimoCusto(angular.toJson($scope.obj));
                    }

                    //AlertaGeralService.
                    //AlertaGeralService.GetGeralPorProduto($scope.idProduto).then(function (response) {
                    //    $scope.produtos = response.data;
                    //});

                    //$scope.dadosinversao = produto.AlertaInversao;
                    //$scope.dadosUltimoCusto = produto.AlertaUltimoCusto;
                    //$scope.dadosHistorico = produto.AlertasHistorico;

                    //AlertaGeralService.GetAllInversaoByProduto($scope.idProduto).then(function (response) {
                    //    $scope.dadosinversao = response.data;
                    //});

                    //AlertaGeralService.GetAllUltCustoByProduto($scope.idProduto).then(function (response) {
                    //    $scope.dadosUltimoCusto = response.data;
                    //});

                    $interval(function () {
                        $uibModalInstance.close();
                    }, 1500);

                }
            };

            $scope.Limpar = function () {
                window.document.getElementById("observacao").value = "";
            }

            $scope.cancel = function () {
                $uibModalInstance.dismiss();
            }
        });

    </script>

    <style>
        body {
            color: #73879C;
            font-family: "Helvetica Neue",Roboto,Arial,"Droid Sans",sans-serif;
        }

        .table {
            font-size: 13px;
        }

        .container {
            margin-top: 30px;
        }

        .icon-td {
            width: 37px;
        }

        .Feito {
            background-color: #82af6f !important;
        }

        .Pendente {
            background-color: #f89406 !important;
        }

        .Problema {
            background-color: #d15b47 !important;
        }

        .ng-hide-add {
            animation: 0.5s lightSpeedOut ease;
        }

        #buscaProduto {
            width: 35%;
        }

        #labelNumberPages {
            font-weight: normal;
            color: #5bc0de;
        }

        .modal-footer {
            margin-top: 10px;
        }

        #observacao {
            height: 134px;
        }

        .tabs li.active a.ng-binding {
            color: #fff;
            background-color: #136352;
            text-decoration: none;
        }

        .tabs li a.ng-binding:hover {
            color: #fff;
            background-color: #136352;
            text-decoration: none;
        }

        .tabs li a.ng-binding {
            background: #20A286;
            color: #fff;
            text-decoration: none;
        }

        .app-modal-window .modal-dialog {
            width: 1200px;
        }

        .red {
            color: indianred;
        }

        .chat_list {
            padding-top: 20px;
        }

            .chat_list .list-group-item {
                padding: 5px 4px;
                min-height: 34px;
                font-size: 13px;
            }

            .chat_list .list-group-item-text {
                word-wrap: break-word;
                display: flex;
                overflow: auto;
            }

            .chat_list .pull-left {
                width: 55px;
                text-align: center;
            }

        span.glyphicon-ok-sign {
            font-size: 2.0em;
            color: #82af6f !important;
        }

        span.glyphicon-remove-sign {
            font-size: 2.0em;
            color: #f89406 !important;
        }

        span.glyphicon-question-sign {
            font-size: 2.0em;
            color: #5bc0de !important;
        }

        .btn-circle {
            width: 49px;
            height: 49px;
            text-align: center;
            padding: 5px 0;
            font-size: 20px;
            line-height: 2.00;
            border-radius: 30px;
        }

        .btn-circle-micro {
            width: 19px;
            height: 19px;
            text-align: center;
            padding: 1px 0;
            font-size: 13px;
            line-height: 0.1;
            border-radius: 30px;
        }

        .Feito {
            background-color: #82af6f !important;
        }

        .Pendente {
            background-color: #f89406 !important;
        }

        .Analisando {
            background-color: #5bc0de !important;
        }

        .select-tipoAlerta {
            margin-bottom: 12px;
            margin-left: 10px;
        }
    </style>

</head>

<body ng-controller="appCtrl as appCtrl">
    <div class="container-fluid" style="margin-top: 10px;">

        <div class="panel panel-info">
            <div class="panel-heading">
                <h3 class="panel-title">Alertas Geral  <i title="Inclusão de Alerta Manual" ng-click="addManual();" class="glyphicon glyphicon-plus-sign pull-right" style="cursor:pointer"></i></h3>
            </div>
            <div class="panel-body">
                <div class="form-inline">
                    <div style="margin-bottom: 12px" class="input-group">
                        <span class="input-group-addon"><i class="glyphicon glyphicon-search"></i></span>
                        <input type="text" style="width:200px;" class="form-control" name="buscaProduto" id="buscaProduto" ng-model="teste" placeholder="Codigo ou Produto">
                    </div>

                    <div class="input-group select-tipoAlerta">
                        <span class="input-group-addon"><i class="glyphicon glyphicon-th-list"></i></span>
                        <select class="form-control" style="width:200px;" ng-model="selectTipoAlerta">
                            <option value="">Selecione Tipo de Alerta</option>
                            <option value="2">Inversão</option>
                            <option value="3">Ultimo Custo</option>
                        </select>
                    </div>

                    <div class="input-group select-tipoAlerta">
                        <span class="input-group-addon"><i class="glyphicon glyphicon-list-alt"></i></span>
                        <select class="form-control" style="width:200px;" ng-model="selectSituacao">
                            <option value="">Selecione a Situação</option>
                            <option value="Novo">Novo</option>
                            <option value="Em Análise">Em Análise</option>
                            <option value="Concluído">Concluído</option>
                        </select>
                    </div>

                    <div style="margin-bottom: 12px" class="input-group">
                        <input type="button" class="btn btn-primary" value="Procurar" ng-click="buscaProduto();" style="margin-left: 10px;" />
                    </div>
                </div>

                <table class="table table-bordered" ng-show="filteredProdutos.length > 0">
                    <thead>
                        <tr>
                            <th ng-click="orderByMe('CdProduto')">Codigo &nbsp<i ng-show="orderBycolumn === 'CdProduto'" ng-class="{'glyphicon glyphicon-sort-by-order': !reverse, 'glyphicon glyphicon-sort-by-order-alt': reverse}"></i></th>
                            <th ng-click="orderByMe('NomeProduto')">Produto &nbsp<i ng-show="orderBycolumn === 'NomeProduto'" ng-class="{'glyphicon glyphicon-sort-by-alphabet': !reverse, 'glyphicon glyphicon-sort-by-alphabet-alt': reverse}"></i></th>
                            <th ng-click="orderByMe('Severidade')">Severidade &nbsp<i ng-show="orderBycolumn === 'Severidade'" ng-class="{'glyphicon glyphicon-sort-by-order': !reverse, 'glyphicon glyphicon-sort-by-order-alt': reverse}"></i></th>
                            <th ng-click="orderByMe('AlertaEmAberto')">Alertas Abertos &nbsp<i ng-show="orderBycolumn === 'AlertaEmAberto'" ng-class="{'glyphicon glyphicon-sort-by-order': !reverse, 'glyphicon glyphicon-sort-by-order-alt': reverse}"></i></th>
                            <th ng-click="orderByMe('DataDoUltimoAlerta')">Data de Geração &nbsp <i ng-show="orderBycolumn === 'DataDoUltimoAlerta'" ng-class="{'glyphicon glyphicon-sort-by-order': !reverse, 'glyphicon glyphicon-sort-by-order-alt': reverse}"></i></th>
                            <th></th>
                            <th></th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr ng-repeat="produto in filteredProdutos | orderBy:orderBycolumn:reverse">
                            <td>{{produto.CdProduto}}</td>
                            <td>{{produto.NomeProduto}}</td>
                            <td>{{produto.Severidade}}</td>
                            <td>{{produto.AlertaEmAberto}}</td>
                            <td>{{produto.DataUltimoAlerta | date:'dd/MM/yyyy'}}</td>
                            <td>
                                <span class="label label-primary">{{produto.Pendente}}</span>
                                <span class="label label-info" uib-popover-html="'<i>{{produto.Vinculado}}</i>'" popover-trigger="'mouseenter'">{{produto.Analise}}</span>
                                <span class="label label-success">{{produto.Concluido}}</span>
                            </td>
                            <td class="icon-td">
                                <a ng-click="ShowModalProduto(produto);">
                                    <span class="glyphicon glyphicon-list-alt" style="cursor: pointer;"></span>
                                </a>
                            </td>
                        </tr>
                    </tbody>
                </table>
                <ul uib-pagination total-items="produtos.length" ng-model="currentPage" max-size="maxSize" class="pagination-sm" boundary-links="true" boundary-link-numbers="true" rotate="false" ng-show="produtos.length > 0"></ul>
                <div class="chat_list" ng-show="filteredProdutos.length == 0">
                    <ul class="list-group">
                        <li class="list-group-item">
                            <div style="text-align:center;">
                                Nenhum registro encontrado!
                            </div>
                        </li>
                    </ul>
                </div>

                <script type="text/ng-template" id="modalTeste.html">
                    <uib-tabset class="tabs">
                        <uib-tab heading="Inversão ({{dadosinversao.length}})">
                            <div class="container">
                                <table class="table table-bordered">
                                    <thead>
                                        <tr>
                                            <th ng-click="orderByMe('CdProduto')">CdProduto &nbsp<i ng-show="orderBycolumn === 'CdProduto'" ng-class="{'glyphicon glyphicon-sort-by-order': !reverse, 'glyphicon glyphicon-sort-by-order-alt': reverse}"></i></th>
                                            <th ng-click="orderByMe('NomeProduto')">Produto &nbsp<i ng-show="orderBycolumn === 'NomeProduto'" ng-class="{'glyphicon glyphicon-sort-by-alphabet': !reverse, 'glyphicon glyphicon-sort-by-alphabet-alt': reverse}"></i></th>
                                            <th ng-click="orderByMe('Pessoa.NomePessoa')">Loja &nbsp<i ng-show="orderBycolumn === 'Pessoa.NomePessoa'" ng-class="{'glyphicon glyphicon-sort-by-order': !reverse, 'glyphicon glyphicon-sort-by-order-alt': reverse}"></i></th>
                                            <th ng-click="orderByMe('QtdEstoque')">Qtd.Estoque &nbsp<i ng-show="orderBycolumn === 'QtdEstoque'" ng-class="{'glyphicon glyphicon-sort-by-order': !reverse, 'glyphicon glyphicon-sort-by-order-alt': reverse}"></i></th>
                                            <th ng-click="orderByMe('DataDeCriacao')">Data de Criação &nbsp <i ng-show="orderBycolumn === 'UltData'" ng-class="{'glyphicon glyphicon-sort-by-order': !reverse, 'glyphicon glyphicon-sort-by-order-alt': reverse}"></i></th>
                                            <th ng-click="orderByMe('Status')">Status &nbsp<i ng-show="orderBycolumn === 'Status'" ng-class="{'glyphicon glyphicon-sort-by-alphabet': !reverse, 'glyphicon glyphicon-sort-by-alphabet-alt': reverse}"></i></th>
                                            <th>
                                                <a href="#" ng-click="showModalTodos(2);" title="Cadastrar Todos">
                                                    <span class="glyphicon glyphicon-asterisk red"></span>
                                                </a>
                                            </th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr ng-repeat="dado in dadosinversao | orderBy:orderBycolumn:reverse">
                                            @*ng-class="dado.AlertasQuarentena.length > 0 ? 'danger' : ''"*@
                                            
                                            @*<td style="text-align:center;"><input type="checkbox" ng-model="dado.checked" ng-checked="selectAll"></td>*@
                                            <td>{{dado.CdProduto}}</td>
                                            <td>{{produto.NomeProduto}}</td>
                                            <td>{{dado.Pessoa.NomePessoa}}</td>
                                            <td>{{dado.QtdEstoque}}</td>
                                            <td>{{dado.DataCriacaoAlerta | date:'dd/MM/yyyy'}}</td>
                                            @*<td><label class="label label-warning">Pendente</label></td>*@
                                            <td><label ng-class="['label {{dado.StatusAlerta}}']">{{dado.StatusAlerta}} </label></td>   
                                            <td class="icon-td">
                                                <a href="#" ng-click="showModal(dado.CdProduto, dado.CdAlertaInversao, dado.Pessoa.CdPessoa, 2);" title="Cadastrar Observação">
                                                    <span class="glyphicon glyphicon-pencil"></span>
                                                </a>
                                            </td>
                                            <td>
                                                
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>

                                <div class="chat_list" ng-show="dadosHistorico.length > 0">
                                    <ul class="list-group">
                                        <li class="list-group-item" ng-repeat="dadoHistorico in dadosHistorico | limitTo: paginationLimit()">
                                            <div class="row">
                                                <div class="col-lg-1">
                                                    <span ng-class="dadoHistorico.StatusAlertaAtual == 'Feito' ?
                                              'glyphicon glyphicon-ok-sign' :
                                              (dadoHistorico.StatusAlertaAtual == 'Pendente' ?
                                              'glyphicon glyphicon-remove-sign' :
                                              'glyphicon glyphicon-question-sign')"></span>
                                                </div>

                                                <div class="col-lg-11">
                                                    <small class="pull-right text-muted">{{dadoHistorico.DataDoHistorico | date:'dd/MM/yyyy'}} as {{dadoHistorico.DataDoHistorico | date:'HH:mm'}}</small>
                                                    <small class="list-group-item-heading text-muted text-primary">{{dadoHistorico.NomeUsuario}}</small>
                                                    <div><strong>Loja: </strong> {{dadoHistorico.Pessoa.NomePessoa}}</div>
                                                    <div><strong>Tipo de Aleta: </strong> {{dadoHistorico.AlertaTipo.NomeAlerta}}</div>
                                                    <div><strong>Alterado de: </strong> {{dadoHistorico.StatusAlertaAnterior}} <strong>para:</strong> {{dadoHistorico.StatusAlertaAtual}} </div>
                                                    <div><strong>Descrição: </strong>{{dadoHistorico.DescricaoHistorico}}</div>
                                                </div>
                                            </div>
                                        </li>
                                    </ul>
                                    @*class="btn btn-circle-sm btn-primary"><span class="glyphicon glyphicon-thumbs-up">*@
                                    <button class="btn btn-circle-micro btn-primary glyphicon glyphicon-plus" ng-show="hasMoreItemsToShow()" ng-click="showMoreItems()"></button>
                                </div>

                                <div class="chat_list" ng-show="dadosHistorico.length == 0">
                                    <ul class="list-group">
                                        <li class="list-group-item">
                                            <div style="text-align:center;">
                                                Esse produto não possui histórico!
                                            </div>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </uib-tab>
                        <uib-tab heading="Ultimo Custo ({{dadosUltimoCusto.length}})">
                            <div class="container">
                                <table class="table table-bordered">
                                    <thead>
                                        <tr>
                                            <th>CdProduto &nbsp</th>
                                            <th>Produto &nbsp</th>
                                            <th>Loja &nbsp</th>
                                            <th>Nota &nbsp</th>
                                            <th>Ultimo Custo &nbsp</th>
                                            <th>Penultimo Custo &nbsp</th>
                                            <th>Diferença &nbsp</th>
                                            <th>Data de Criação &nbsp</th>
                                            <th>Status &nbsp</th>
                                            <th>
                                                <a href="#" ng-click="showModalTodos(3);" title="Cadastrar Todos">
                                                    <span class="glyphicon glyphicon-asterisk red"></span>
                                                </a>
                                            </th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr ng-repeat="dadoUltimoCusto in dadosUltimoCusto | orderBy:orderBycolumn:reverse">
                                            @*<td style="text-align:center;"><input type="checkbox" ng-model="dado.checked" ng-checked="selectAll"></td>*@
                                            <td>{{dadoUltimoCusto.CdProduto}}</td>
                                            <td>{{produto.NomeProduto}}</td>
                                            <td>{{dadoUltimoCusto.Pessoa.NomePessoa}}</td>
                                            <td>{{dadoUltimoCusto.Nota}}</td>
                                            <td>{{dadoUltimoCusto.UltimoCusto | currency:"R$"}}</td>
                                            <td>{{dadoUltimoCusto.PenultimoCusto | currency:"R$"}}</td>
                                            <td>{{dadoUltimoCusto.Diferenca}}%</td>
                                            <td>{{dadoUltimoCusto.DataCriacaoAlerta | date:'dd/MM/yyyy'}}</td>
                                            @*<td><label class="label label-warning">Pendente</label></td>*@
                                            <td><label ng-class="['label {{dadoUltimoCusto.StatusAlerta}}']">{{dadoUltimoCusto.StatusAlerta}} </label></td>
                                            <td class="icon-td">
                                                <a href="#" ng-click="showModal(dadoUltimoCusto.CdProduto, dadoUltimoCusto.CdAlertaUltCusto, dadoUltimoCusto.Pessoa.CdPessoa, 3);" title="Cadastrar Observação">
                                                    <span class="glyphicon glyphicon-pencil"></span>
                                                </a>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>

                                <div class="chat_list" ng-show="dadosHistorico.length > 0">
                                    <ul class="list-group">
                                        <li class="list-group-item" ng-repeat="dadoHistorico in dadosHistorico | limitTo: paginationLimit()">
                                            <div class="row">
                                                <div class="col-lg-1">
                                                    <span ng-class="dadoHistorico.StatusAlertaAtual == 'Feito' ?
                                              'glyphicon glyphicon-ok-sign' :
                                              (dadoHistorico.StatusAlertaAtual == 'Pendente' ?
                                              'glyphicon glyphicon-remove-sign' :
                                              'glyphicon glyphicon-question-sign')"></span>
                                                </div>

                                                <div class="col-lg-11">
                                                    <small class="pull-right text-muted">{{dadoHistorico.DataDoHistorico | date:'dd/MM/yyyy'}} as {{dadoHistorico.DataDoHistorico | date:'HH:mm'}}</small>
                                                    <small class="list-group-item-heading text-muted text-primary">{{dadoHistorico.NomeUsuario}}</small>
                                                    <div><strong>Loja: </strong> {{dadoHistorico.Pessoa.NomePessoa}}</div>
                                                    <div><strong>Tipo de Aleta: </strong> {{dadoHistorico.AlertaTipo.NomeAlerta}}</div>
                                                    <div><strong>Alterado de: </strong> {{dadoHistorico.StatusAlertaAnterior}} <strong>para:</strong> {{dadoHistorico.StatusAlertaAtual}} </div>
                                                    <div><strong>Descrição: </strong>{{dadoHistorico.DescricaoHistorico}}</div>
                                                </div>
                                            </div>
                                        </li>
                                    </ul>
                                    @*class="btn btn-circle-sm btn-primary"><span class="glyphicon glyphicon-thumbs-up">*@
                                    <button class="btn btn-circle-micro btn-primary glyphicon glyphicon-plus" ng-show="hasMoreItemsToShow()" ng-click="showMoreItems()"></button>
                                </div>

                                <div class="chat_list" ng-show="dadosHistorico.length == 0">
                                    <ul class="list-group">
                                        <li class="list-group-item">
                                            <div style="text-align:center;">
                                                Esse produto não possui histórico!
                                            </div>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </uib-tab>
                        @*<uib-tab heading="Long Justified">Long Labeled Justified content</uib-tab>
                            <uib-tab heading="Justified">Justified content</uib-tab>
                            <uib-tab heading="SJ">Short Labeled Justified content</uib-tab>
                            <uib-tab heading="Long Justified">Long Labeled Justified content</uib-tab>*@
                    </uib-tabset>
                </script>

                @*Inicio Modal Observação*@

                <script type="text/ng-template" id="myModal.html">
                    <div class="modal-header">
                        <h4 class="modal-title">Produto</h4>
                        <button class="close" style="margin-top: -32px;" ng-click="cancel();">
                            <span>&times;</span>
                        </button>
                    </div>

                    <div class="modal-body">
                        <form name="obsForm" id="obsForm">
                            <div>
                                <label class="form-control-label" style="color:red;">*<label style="color: #337ab7;">Observação:</label></label>
                                <textarea class="form-control" name="observacao" id="observacao" style="height: 134px;" ng-model="observacao" required></textarea>
                            </div>

                            <div style="margin-top: 30px;">
                                <label class="form-control-label" style="color:red;">*<label style="color: #337ab7;">Status:</label></label>
                                <select class="form-control input-sm" style="width: auto;" ng-model="status" ng-required="true" name="status" id="status">
                                    <option selected="selected" style="color: #5bc0de;">Analisando</option>
                                    <option style="color: #f0ad4e;">Pendente</option>
                                    <option style="color: #5cb85c;">Feito</option>
                                </select>
                            </div>
                        </form>
                    </div>

                    <div class="modal-footer" style="margin-top: 10px;">
                        <input type="button" id="limpar" class="btn btn-info" value="Limpar" ng-click="Limpar();">
                        <input type="button" id="Gravar" class="btn btn-primary" value="Gravar" ng-click="Gravar();">
                    </div>

                    <div class="alert alert-danger" ng-show="obsForm.observacao.$invalid && submitted">
                        <span class="glyphicon glyphicon-hand-right"></span> <strong>Danger Message</strong>
                        <hr class="message-inner-separator">
                        <p>
                            Preencha o campo <strong>Observação</strong> corretamente!
                        </p>
                    </div>

                    <div class="alert alert-danger" ng-show='obsForm.status.$invalid && submitted'>
                        <span class="glyphicon glyphicon-hand-right"></span> <strong>Danger Message</strong>
                        <hr class="message-inner-separator">
                        <p>
                            Preencha o campo <strong>Status</strong> corretamente!
                        </p>
                    </div>

                    <div class="alert alert-success" ng-show='(obsForm.status.$valid && obsForm.observacao.$valid) && submitted'>
                        <span class="glyphicon glyphicon-hand-up"></span> <strong>Sucesso</strong>
                        <hr class="message-inner-separator">
                        <p>
                            <strong>Observação</strong> gravada com sucesso!
                        </p>
                    </div>

                </script>
                @*Fim Modal Observação*@


                <script type="text/ng-template" id="modalAddAlertaManual.html">
                    <div class="modal-content">
                        <div class="panel panel-primary" style="margin-bottom:0px;">
                            <div class="panel-heading">
                                <h3 class="panel-title">Cadastro Alerta Manual</h3>
                            </div>
                            <form class="form-horizontal" name="addForm" style="margin-top: 15px; margin-bottom: 15px;">

                                <div class="form-group">
                                    <label class="col-sm-2 col-sm-offset-1 input-group">Codigo</label>
                                </div>
                                <div class="form-group">
                                    <div class="col-sm-10 col-sm-offset-1 input-group">
                                        <span class="input-group-addon alert-info glyphicon glyphicon-search" ng-click="searchByCodigo();"></span>
                                        <input type="text" class="form-control" ng-model="cdProduto" name="cdProduto" id="cdProduto" placeholder="Codigo" ng-required="true" />
                                    </div>
                                </div>

                                <div class="form-group">
                                    <label class="col-sm-2 col-sm-offset-1 input-group">Produto</label>
                                </div>

                                <div class="form-group">
                                    <div class="col-sm-10 col-sm-offset-1 input-group">
                                        <span class="input-group-addon alert-info glyphicon glyphicon-search" ng-click="searchByProduto();"></span>
                                        <input type="text" class="form-control" ng-model="produto" name="produto" id="produto" placeholder="Nome do Produto" ng-required="true" />
                                    </div>
                                </div>

                                <div class="form-group">
                                    <label class="col-sm-2 col-sm-offset-1 input-group">Filial</label>
                                </div>
                                <div class="form-group">
                                    <div class="col-sm-10 col col-sm-offset-1 input-group">
                                        <ui-select multiple sortable="true" title="Escolha as filiais..." ng-model="appCtrl.filiais" name="filiais" id="filiais">
                                            <ui-select-match placeholder="Escolha as filiais....">{{$item.nmFilial}}</ui-select-match>
                                            <ui-select-choices repeat="filiais in filiaisDiponiveis">
                                                {{filiais.nmFilial}}
                                            </ui-select-choices>
                                        </ui-select>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-sm-3 col-sm-offset-1 input-group">Tipo de Erro</label>
                                </div>
                                <div class="form-group">
                                    <div class="col-sm-10 col col-sm-offset-1 input-group">
                                        <span class="input-group-addon alert-info glyphicon glyphicon-plus" ng-click="addTipoAlerta();"></span>
                                        <select class="form-control" name="tipoAlerta" id="tipoAlerta" placeholder="Tipo de Alerta" ng-required="true" ng-model="tipoAlerta" ng-options="item.NomeAlerta for item in tiposAlerta" ng-change="change(tipoAlerta)"></select>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-sm-2 col-sm-offset-1 input-group">Comentário</label>
                                </div>
                                <div class="form-group">
                                    <div class="col-sm-10 col-sm-offset-1 input-group">
                                        <textarea class="form-control" name="comentario" id="comentario" style="height: 134px;" ng-model="comentario"></textarea>
                                    </div>
                                </div>
                                <button class="btn btn-primary" style="margin-left:82%" ng-click="gravarAlerta()">Gravar</button>
                            </form>

                            <div class="alert alert-danger" ng-show="addForm.cdProduto.$error.required && submitted">
                                <span class="glyphicon glyphicon-hand-right"></span> <strong>Danger Message</strong>
                                <hr class="message-inner-separator">
                                <p>
                                    Preencha o campo <strong>Codigo</strong> corretamente!
                                </p>
                            </div>

                            <div class="alert alert-danger" ng-show="addForm.produto.$error.required && submitted">
                                <span class="glyphicon glyphicon-hand-right"></span> <strong>Danger Message</strong>
                                <hr class="message-inner-separator">
                                <p>
                                    Preencha o campo <strong>Produto</strong> corretamente!
                                </p>
                            </div>

                            <div class="alert alert-danger" ng-show="addForm.tipoAlerta.$error.required && submitted">
                                <span class="glyphicon glyphicon-hand-right"></span> <strong>Danger Message</strong>
                                <hr class="message-inner-separator">
                                <p>
                                    Preencha o campo <strong>Tipo de Alerta</strong> corretamente!
                                </p>
                            </div>

                            <div class="alert alert-danger" ng-show="appCtrl.filiais == 0 && submitted">
                                <span class="glyphicon glyphicon-hand-right"></span> <strong>Danger Message</strong>
                                <hr class="message-inner-separator">
                                <p>
                                    Preencha o campo <strong>Filial</strong> corretamente!
                                </p>
                            </div>
                        </div>
                    </div>
                </script>

                <script type="text/ng-template" id="modalLoad.html">
                    <div class="modal-body">
                        <uib-progressbar class="progress-striped active" max="100" value="dynamic">%{{dynamic}} <i ng-sh<i ng-show="showWarning">!!! Watch out !!!</i></uib-progressbar>
                    </div>
                </script>

                <script type="text/ng-template" id="modalAddTipoAlerta.html">
                    <div class="modal-content">
                        <div class="panel panel-primary" style="margin-bottom:0px;">
                            <div class="panel-heading">
                                <h3 class="panel-title">Cadastro Tipo de Alerta</h3>
                            </div>
                            <form class="form-horizontal" id="addTipoAlertaForm" name="addTipoAlertaForm" style="margin-top: 15px; margin-bottom: 15px;">
                                <div class="form-group col-sm-12" style="margin-left:auto;">
                                    <input type="text" class="form-control col-sm-9" ng-model="alertaNovo" name="alertaNovo" id="alertaNovo" placeholder="Novo tipo de Erro" ng-required="true" />
                                </div>
                                <button class="btn btn-primary" style="margin-left:14px;" ng-click="gravarTipoAlerta();">Gravar</button>
                            </form>
                        </div>
                    </div>
                </script>

                <script type="text/ng-template" id="success.html">
                    <div class="alert alert-success" style="margin-bottom:0px;">
                        Tipo de erro cadastrado com <strong>sucesso!</strong>
                    </div>
                </script>
            </div>
        </div>
    </div>
</body>
</html>