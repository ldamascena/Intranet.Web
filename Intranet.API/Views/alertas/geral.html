<div class="row wrapper border-bottom white-bg page-heading">
    <div class="col-lg-10">
        <h2>Geral</h2>
        <ol class="breadcrumb">
            <li>
                <a ui-sref="principal.instutucional">Home</a>
            </li>
            <li>
                <a>Alertas</a>
            </li>
            <li class="active">
                <strong>Geral</strong>
            </li>
        </ol>
    </div>
    <div class="col-lg-2">
    </div>
</div>
<div class="wrapper wrapper-content animated fadeInRight" ng-controller="geralCtrl">
    <div class="row animated fadeIn" ng-show="produtosUltimoCusto.length > 0 || produtosInversao.length">
        <div class="col-lg-12">
            <div class="ibox float-e-margins">
                <div class="ibox-title">
                    <h5>Alerta - <strong>Geral (Produto)</strong></h5>
                    <div ibox-tools></div>
                </div>
                <div class="ibox-content">
                    <div class="tabs-container">
                        <uib-tabset>
                            <uib-tab>
                                <uib-tab-heading>
                                    Inversao <label class="badge badge-info">  {{produtosInversao.length}}</label>
                                </uib-tab-heading>
                                <table class="table table-striped table-bordered table-hover">
                                    <thead>
                                        <tr>
                                            <th>CdProduto</th>
                                            <th>Produto</th>
                                            <th>Loja</th>
                                            <th>Estoque</th>
                                            <th>Data Alerta</th>
                                            <th>Status</th>
                                            <th><button type="button" class="btn btn-sm btn-outline btn-danger btn-rounded" ng-click="cadastrarObsTodos(produtosInversao)"><i class="fa fa-edit"> Edit</i></button></th>
                                            <th><button type="button" class="btn btn-sm btn-outline btn-danger btn-rounded" ng-click="quarentenaTodos(produtosInversao)"><i class="fa fa-ban"> Quarantine</i></button></th>
                                            <th></th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr ng-repeat="produtoInversao in produtosInversao" ng-class="produtoInversao.AlertasQuarentena.length > 0 ? 'danger': ''">
                                            <td>{{produtoInversao.CdProduto}}</td>
                                            <td>{{produtoInversao.NomeProduto}}</td>
                                            <td>{{produtoInversao.Pessoa.NomePessoa}}</td>
                                            <td>{{produtoInversao.QtdEstoque}}</td>
                                            <td>{{produtoInversao.UltData | date:'dd/MM/yyyy'}}</td>

                                            <td>
                                                <label ng-class="produtoInversao.AlertaStatus.nomeStatus == 'Novo' ?
                                           'badge badge-success' :
                                           (produtoInversao.AlertaStatus.nomeStatus == 'Concluido' ?
                                           'badge badge-primary' :
                                           (produtoInversao.AlertaStatus.nomeStatus == 'Analise' ?
                                           'badge badge-info' :
                                           'badge badge-danger'))">
                                                    {{produtoInversao.AlertaStatus.nomeStatus}}
                                                </label>
                                            </td>
                                            <td class="icon-td">
                                                <button type="button" class="btn btn-sm btn-outline btn-info btn-rounded" ng-click="cadastrarObs(produtoInversao)"><i class="fa fa-edit"> Edit</i></button>
                                            </td>
                                            <td class="icon-td">
                                                <button type="button" class="btn btn-sm btn-outline btn-warning btn-rounded" ng-click="quarentena(produtoInversao)"><i class="fa fa-ban"> Quarantine</i></button>
                                            </td>
                                            <td class="icon-td">
                                                <button type="button" class="btn btn-sm btn-outline btn-success btn-rounded" ng-click="historico(produtoInversao)"><i class="fa fa-comments-o"> Historic</i></button>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </uib-tab>
                            <uib-tab>
                                <uib-tab-heading>
                                    Ultimo Custo <label class="badge badge-info">  {{produtosUltimoCusto.length}}</label>
                                </uib-tab-heading>
                                <table class="table table-striped table-bordered table-hover">
                                    <thead>
                                        <tr>
                                            <th>CdProduto</th>
                                            <th>Produto</th>
                                            <th>Loja</th>
                                            <th>Nota</th>
                                            <th>Ultimo Custo</th>
                                            <th>Penultimo Custo</th>
                                            <th>Diferença</th>
                                            <th>Data Alerta</th>
                                            <th>Status</th>
                                            <th><button type="button" class="btn btn-sm btn-outline btn-danger btn-rounded" ng-click="cadastrarObsTodos(produtosUltimoCusto)"><i class="fa fa-edit"> Edit</i></button></th>
                                            <th><button type="button" class="btn btn-sm btn-outline btn-danger btn-rounded" ng-click="quarentenaTodos(produtosUltimoCusto)"><i class="fa fa-ban"> Quarantine</i></button></th>
                                            <th></th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr ng-repeat="produtoUltimoCusto in produtosUltimoCusto" ng-class="produtoUltimoCusto.AlertasQuarentena.length > 0 ? 'danger': ''">
                                            <td>{{produtoUltimoCusto.CdProduto}}</td>
                                            <td>{{produtoUltimoCusto.NomeProduto}}</td>
                                            <td>{{produtoUltimoCusto.Pessoa.NomePessoa}}</td>
                                            <td>{{produtoUltimoCusto.Nota}}</td>
                                            <td>{{produtoUltimoCusto.UltimoCusto | currency}}</td>
                                            <td>{{produtoUltimoCusto.PenultimoCusto | currency}}</td>
                                            <td>{{produtoUltimoCusto.Diferenca}}%</td>
                                            <td>{{produtoUltimoCusto.UltData | date:'dd/MM/yyyy'}}</td>

                                            <td>
                                                <label ng-class="produtoUltimoCusto.AlertaStatus.nomeStatus == 'Novo' ?
                                           'badge badge-success' :
                                           (produtoUltimoCusto.AlertaStatus.nomeStatus == 'Concluido' ?
                                           'badge badge-primary' :
                                           (produtoUltimoCusto.AlertaStatus.nomeStatus == 'Analise' ?
                                           'badge badge-info' :
                                           'badge badge-danger'))">
                                                    {{produtoUltimoCusto.AlertaStatus.nomeStatus}}
                                                </label>
                                            </td>
                                            <td class="icon-td">
                                                <button type="button" class="btn btn-sm btn-outline btn-info btn-rounded" ng-click="cadastrarObs(produtoUltimoCusto)"><i class="fa fa-edit"> Edit</i></button>
                                            </td>
                                            <td class="icon-td">
                                                <button type="button" class="btn btn-sm btn-outline btn-warning btn-rounded" ng-click="quarentena(produtoUltimoCusto)"><i class="fa fa-ban"> Quarantine</i></button>
                                            </td>
                                            <td class="icon-td">
                                                <button type="button" class="btn btn-sm btn-outline btn-success btn-rounded" ng-click="historico(produtoUltimoCusto)"><i class="fa fa-comments-o"> Historic</i></button>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </uib-tab>  
                        </uib-tabset>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-lg-12">
            <div class="ibox float-e-margins">
                <div class="ibox-title">
                    <h5>Alerta - <strong>Geral (Lista)</strong></h5>
                    <div ibox-tools></div>
                </div>
                <div class="ibox-content">

                    <table datatable="ng" dt-options="dtOptions" class="table table-striped table-bordered table-hover dataTables-example">
                        <thead>
                            <tr>
                                <th>Codigo</th>
                                <th>Produto</th>
                                <th>Abertos</th>
                                <th>Severidade</th>
                                <th></th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr ng-repeat="geral in gerais | reverse" ng-class="geral.InQuarentena == 1 ? 'danger': ''">
                                <td>{{geral.cdProduto}}</td>
                                <td>{{geral.Produto}}</td>
                                <td>{{geral.Abertos}}</td>
                                <td>{{geral.Severidade}}</td>
                                <td>
                                    <button type="button" class="btn btn-sm btn-outline btn-primary btn-rounded" ng-click="visualizar(geral)"><i class="fa fa-eye"> Visualizar</i></button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>
